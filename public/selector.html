<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generación</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;300;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style_selection.css">
</head>
<body>

  <header>
    <h1 id="titulo"</h1>
    <div id="galeria"></div>
    <h2>Seleccione las fotos que desea</h2>
    <button id="descargar" class="boton-enviar">Enviar</button>
  </header>

  <section class="galeria" id="galeria">
  </section>

<script>
  const params = new URLSearchParams(window.location.search);
  const gen = params.get("gen");
  const grupo = params.get("grupo");
  const email = params.get("email");

  let carpeta = "";
  let titulo = "";
  let tipo = "";                // "generaciones" o "grupos"

  if (gen) {
    carpeta = gen;
    tipo = "generaciones";
    titulo = `Generación ${gen}`;
  } else if (grupo) {
    carpeta = grupo;
    tipo = "grupos";
   
    const nombres = {
      maestros: "Maestros",
      administracion: "Administración",
      mantenimiento: "Mantenimiento",
      extraescolares: "Grupos Extraescolares"
    };
    titulo = `Grupo: ${nombres[grupo] || grupo}`;
  } else {
    document.body.innerHTML = "<h2 style='text-align:center'>No se especificó ni generación ni grupo.</h2>";
    throw new Error("No hay parámetro válido.");
  }

  document.getElementById("titulo").innerText = titulo;
  const thumbPath = `Images/thumbnails/${carpeta}/`;

  fetch(thumbPath)
    .then(res => {
      if (!res.ok) throw new Error("No se pudo acceder a la carpeta de miniaturas.");
      return res.text(); // esto requiere que el servidor permita listar contenido
    })
    .then(html => {

    const matches = html.match(/href="([^"]+\.(jpg|jpeg|png|webp))"/gi);
    const imagenes = matches ? matches.map(m => m.match(/"([^"]+)"/)[1]) : [];

      if (imagenes.length === 0) {
        document.getElementById("galeria").innerHTML = "<p>No hay imágenes disponibles.</p>";
        return;
      }

      const galeria = document.getElementById("galeria");

      imagenes.forEach(nombre => {
        const img = document.createElement("img");
        img.src = `${thumbPath}${nombre}`;
        img.alt = nombre;
        img.className = "foto";
        galeria.appendChild(img);
      });
    })
    .catch(err => {
      console.error(err);
      document.getElementById("galeria").innerHTML = "<p>Error al cargar las miniaturas.</p>";
    });
</script>

  </body>
</html>
